<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>نظام إخفاء النصوص في الصور</title>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.19/tailwind.min.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700&display=swap');
    :root {
      --primary-gradient: linear-gradient(135deg, #6366f1, #3b82f6);
      --secondary-gradient: linear-gradient(135deg, #8b5cf6, #6366f1);
      --dark-background: linear-gradient(135deg, #0f172a 0%, #1e1b4b 100%);
      --card-bg: rgba(30, 41, 59, 0.7);
      --accent-color: #6366f1;
      --accent-light: #818cf8;
      --text-color: #e2e8f0;
    }
    body {
      font-family: 'Tajawal', sans-serif;
      background: var(--dark-background);
      min-height: 100vh;
      color: var(--text-color);
      line-height: 1.6;
    }
    .glass-morphism {
      background: var(--card-bg);
      backdrop-filter: blur(15px);
      border: 1px solid rgba(255, 255, 255, 0.125);
      box-shadow: 0 10px 40px rgba(31, 38, 135, 0.4);
      border-radius: 1.5rem;
      transition: all 0.3s ease;
    }
    .glass-morphism:hover {
      transform: translateY(-5px);
      box-shadow: 0 15px 50px rgba(31, 38, 135, 0.5);
    }
    .gradient-text {
      background: var(--primary-gradient);
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
    }
    .gradient-text-small {
      background: var(--secondary-gradient);
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
    }
    .elegant-input {
      background: rgba(30, 41, 59, 0.5) !important;
      border: 2px solid rgba(129, 140, 248, 0.3) !important;
      transition: all 0.3s ease;
    }
    .elegant-input:focus {
      border-color: var(--accent-color) !important;
      box-shadow: 0 0 10px rgba(99, 102, 241, 0.2);
    }
    .file-dropzone {
      border: 2px dashed var(--accent-light);
      transition: all 0.3s ease;
      position: relative;
    }
    .file-dropzone:hover {
      border-color: var(--accent-color);
      background: rgba(99, 102, 241, 0.1);
    }
    .tab {
      cursor: pointer;
      transition: all 0.3s ease;
      position: relative;
    }
    .tab.active {
      border-bottom: 3px solid var(--accent-color);
      background: rgba(99, 102, 241, 0.1);
    }
    .about-card {
      transition: all 0.3s ease;
      border: 1px solid rgba(99, 102, 241, 0.2);
      height: 100%;
      display: flex;
      flex-direction: column;
    }
    .about-card:hover {
      transform: translateY(-5px);
      background: rgba(79, 70, 229, 0.15);
      box-shadow: 0 10px 25px rgba(79, 70, 229, 0.2);
    }
    .about-icon {
      background: rgba(99, 102, 241, 0.15);
      height: 60px;
      width: 60px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 50%;
      margin-bottom: 1rem;
    }
    .feature-icon {
      font-size: 1.5rem;
      color: var(--accent-light);
    }
    .footer-link {
      transition: all 0.3s ease;
    }
    .footer-link:hover {
      color: var(--accent-light);
      transform: translateY(-2px);
    }
    .feature-section {
      position: relative;
      overflow: hidden;
    }
    .feature-section::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: radial-gradient(circle at center, rgba(99, 102, 241, 0.1) 0%, transparent 70%);
      pointer-events: none;
    }
    .icon-glow {
      filter: drop-shadow(0 0 3px rgba(129, 140, 248, 0.5));
    }
    .hidden {
      display: none !important;
    }
    .animated-gradient {
      background-size: 400% 400%;
      animation: gradient-shift 15s ease infinite;
    }
    @keyframes gradient-shift {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }
    .floating {
      animation: float 3s ease-in-out infinite;
    }
    @keyframes float {
      0% { transform: translateY(0px); }
      50% { transform: translateY(-10px); }
      100% { transform: translateY(0px); }
    }
    .pulsate {
      animation: pulse 2s infinite;
    }
    @keyframes pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.05); }
      100% { transform: scale(1); }
    }
    .shine-effect {
      position: relative;
      overflow: hidden;
    }
    .shine-effect::after {
      content: '';
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: linear-gradient(
        to bottom right,
        rgba(255, 255, 255, 0) 0%,
        rgba(255, 255, 255, 0.05) 40%,
        rgba(255, 255, 255, 0.1) 50%,
        rgba(255, 255, 255, 0.05) 60%,
        rgba(255, 255, 255, 0) 100%
      );
      transform: rotate(30deg);
      animation: shine 6s linear infinite;
      pointer-events: none;
    }
    @keyframes shine {
      0% { transform: translateX(-100%) rotate(30deg); }
      100% { transform: translateX(100%) rotate(30deg); }
    }
    .file-dropzone::after {
      content: '';
      position: absolute;
      top: -2px;
      left: -2px;
      right: -2px;
      bottom: -2px;
      border: 2px dashed var(--accent-light);
      border-radius: 0.75rem;
      pointer-events: none;
    }

    .file-preview {
      border: none !important; 
      max-width: 90%;
      margin: 1rem auto;
    }
   
    
    .btn-primary {
      background: linear-gradient(135deg, #6366f1, #4f46e5);
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }
    .btn-primary:hover {
      background: linear-gradient(135deg, #4f46e5, #4338ca);
      transform: translateY(-2px);
    }
    .btn-primary::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, rgba(255,255,255,0.1), rgba(255,255,255,0));
      transition: all 0.3s ease;
    }
    .btn-primary:hover::after {
      opacity: 0.5;
    }
    .btn-secondary {
      background: linear-gradient(135deg, #8b5cf6, #6366f1);
      transition: all 0.3s ease;
    }
    .btn-secondary:hover {
      background: linear-gradient(135deg, #7c3aed, #4f46e5);
      transform: translateY(-2px);
    }
    .badge {
      padding: 0.25rem 0.75rem;
      border-radius: 9999px;
      font-size: 0.75rem;
      background: rgba(99, 102, 241, 0.2);
      color: var(--accent-light);
      border: 1px solid rgba(99, 102, 241, 0.3);
      transition: all 0.3s ease;
    }
    .badge:hover {
      background: rgba(99, 102, 241, 0.3);
      transform: scale(1.05);
    }
    .tooltip {
      position: relative;
      display: inline-block;
    }
    .tooltip .tooltip-text {
      visibility: hidden;
      width: 200px;
      background-color: rgba(15, 23, 42, 0.95);
      color: #fff;
      text-align: center;
      border-radius: 6px;
      padding: 10px;
      position: absolute;
      z-index: 1;
      bottom: 125%;
      left: 50%;
      transform: translateX(-50%);
      opacity: 0;
      transition: opacity 0.3s;
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
      border: 1px solid rgba(99, 102, 241, 0.3);
    }
    .tooltip:hover .tooltip-text {
      visibility: visible;
      opacity: 1;
    }
    .security-card {
      background: rgba(30, 41, 59, 0.5);
      border: 1px solid rgba(99, 102, 241, 0.2);
      transition: all 0.3s ease;
    }
    .security-card:hover {
      background: rgba(30, 41, 59, 0.7);
      border-color: rgba(99, 102, 241, 0.4);
    }
    .form-header {
      position: relative;
      padding-bottom: 0.5rem;
      margin-bottom: 1.5rem;
    }
    .form-header::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      width: 50px;
      height: 3px;
      background: var(--primary-gradient);
      border-radius: 3px;
    }
    .progress-step {
      position: relative;
      padding-left: 1.5rem;
    }
    .progress-step::before {
      content: '';
      position: absolute;
      left: 0;
      top: 0.5rem;
      width: 12px;
      height: 12px;
      border-radius: 50%;
      background: var(--accent-color);
    }
    .progress-line {
      position: absolute;
      left: 6px;
      top: 1rem;
      bottom: -0.5rem;
      width: 2px;
      background: rgba(99, 102, 241, 0.3);
    }
    .checkbox-custom {
      position: relative;
      padding-right: 2rem;
    }
    .checkbox-custom input {
      position: absolute;
      opacity: 0;
      height: 0;
      width: 0;
    }
    .checkmark {
      position: absolute;
      top: 0;
      right: 0;
      height: 20px;
      width: 20px;
      background-color: rgba(30, 41, 59, 0.5);
      border: 2px solid rgba(99, 102, 241, 0.3);
      border-radius: 4px;
      transition: all 0.3s ease;
    }
    .checkbox-custom:hover input ~ .checkmark {
      background-color: rgba(99, 102, 241, 0.1);
    }
    .checkbox-custom input:checked ~ .checkmark {
      background-color: var(--accent-color);
    }
    .checkmark:after {
      content: "";
      position: absolute;
      display: none;
    }
    .checkbox-custom input:checked ~ .checkmark:after {
      display: block;
    }
    .checkbox-custom .checkmark:after {
      left: 6px;
      top: 2px;
      width: 5px;
      height: 10px;
      border: solid white;
      border-width: 0 2px 2px 0;
      transform: rotate(45deg);
    }
  </style>
</head>
<body class="p-4 md:p-8">
  <div class="container mx-auto max-w-6xl">
    <header class="text-center mb-12">
      <div class="mb-4 flex justify-center">
        <div class="w-16 h-16 bg-indigo-900/30 rounded-full flex items-center justify-center mb-2 floating">
          <i class="fas fa-shield-alt text-3xl text-indigo-400 icon-glow"></i>
        </div>
      </div>
      <h1 class="text-4xl md:text-5xl font-bold mb-6 gradient-text animated-gradient">
         الإخفاء الآمن  
      </h1>
      <p class="text-xl text-gray-300 max-w-2xl mx-auto mb-8">
        أداة لإخفاء النصوص السرية داخل الصور باستخدام تقنية 
        <span class="tooltip">
          LSB
          <span class="tooltip-text">Least Significant Bit - تقنية تعديل البت الأقل أهمية في بيانات الصورة دون تأثير ملحوظ على جودتها</span>
        </span>
      </p>
      
      <div class="flex justify-center mb-10">
        <div class="inline-flex bg-gray-800/50 rounded-xl overflow-hidden border border-indigo-900/30 shadow-lg">
          <div id="encrypt-tab" class="tab active py-4 px-10 flex items-center shine-effect" onclick="switchTab('encrypt')">
            <i class="fas fa-lock ml-3 text-indigo-400"></i>
            <span>تشفير</span>
          </div>
          <div id="decrypt-tab" class="tab py-4 px-10 flex items-center shine-effect" onclick="switchTab('decrypt')">
            <i class="fas fa-unlock ml-3 text-indigo-400"></i>
            <span>فك التشفير</span>
          </div>
        </div>
      </div>
    </header>
    
    <div class="grid grid-cols-1 gap-10">
      <!-- قسم التشفير -->
      <div id="encrypt-section" class="glass-morphism p-8 md:p-10 w-full">
        <h2 class="text-2xl font-bold mb-8 text-indigo-300 flex items-center form-header">
          <i class="fas fa-lock ml-3 text-indigo-400"></i>
          تشفير النص
        </h2>
        <form action="/encrypt" method="POST" enctype="multipart/form-data">
          <div class="mb-8">
            <label class="block text-lg mb-4 flex items-center">
              <i class="fas fa-image ml-3 text-indigo-400"></i>
              اختر الصورة الأصلية
              <span class="mr-2 badge">مطلوب</span>
            </label>
            <div class="file-dropzone rounded-xl p-8 text-center cursor-pointer hover:shadow-lg transition-all ease-in-out duration-300"
                 onclick="document.getElementById('encrypt-image').click()">
              <div class="text-gray-400 flex flex-col items-center">
                <i class="fas fa-cloud-upload-alt text-5xl mb-3 text-indigo-400 icon-glow pulsate"></i>
                <span class="mb-2">اسحب الصورة هنا أو اضغط للاختيار</span>
                <span class="text-xs text-gray-500">نوصي باستخدام صور PNG/JPG بدقة عالية</span>
              </div>
              <input type="file" id="encrypt-image" name="image" accept="image/*" class="hidden" required>
            </div>
            <div id="encrypt-preview" class="mt-4 rounded-lg overflow-hidden file-preview"></div>
          </div>
          
          <div class="mb-8">
            <label class="block text-lg mb-4 flex items-center">
              <i class="fas fa-file-alt ml-3 text-purple-400"></i>
              رفع ملف نصي (.txt)
              <span class="mr-2 badge bg-green-900/30 text-green-400 border-green-600/30">اختياري</span>
            </label>
            <div class="file-dropzone rounded-xl p-6 text-center cursor-pointer transition-all ease-in-out duration-300"
                 onclick="document.getElementById('secret-file').click()">
              <div class="text-gray-400 flex flex-col items-center">
                <i class="fas fa-file-upload text-4xl mb-4 text-purple-400 icon-glow"></i>
                <span class="mb-2">اسحب الملف هنا أو اضغط للاختيار</span>
                <span class="text-xs text-gray-500">ملف txt</span>
              </div>
              <input type="file" id="secret-file" name="secret_file" accept=".txt" class="hidden">
            </div>
            <div id="secret-filename" class="text-sm text-gray-400 mt-2 px-3"></div>
          </div>
          
          <div class="mb-8">
            <label class="block text-lg mb-4 flex items-center">
              <i class="fas fa-keyboard ml-3 text-blue-400"></i>
              أو أدخل النص مباشرةً
              <span class="mr-2 tooltip">
                <i class="fas fa-info-circle text-gray-400"></i>
                <span class="tooltip-text">أدخل النص السري الذي تريد إخفاءه في الصورة. سيتم تجاهل هذا الحقل إذا قمت برفع ملف نصي</span>
              </span>
            </label>
            <textarea name="text" class="w-full elegant-input text-white p-4 rounded-lg"
                      rows="4" placeholder="اكتب النص السري هنا..."></textarea>
            <div class="flex justify-between mt-2 text-xs text-gray-400 px-2">
              <span>حتى 10,000 حرف</span>
              <span id="char-count">0 / 10,000</span>
            </div>
          </div>
          
          <div class="mb-8">
            <label class="block text-lg mb-4 flex items-center">
              <i class="fas fa-key ml-3 text-yellow-400"></i>
              المفتاح السري (44 حرفًا base64)
              <span class="mr-2 badge">مطلوب</span>
              <span class="mr-2 tooltip">
                <i class="fas fa-info-circle text-gray-400"></i>
                <span class="tooltip-text">المفتاح المستخدم لتشفير النص. سيكون مطلوبًا لاحقًا عند فك التشفير</span>
              </span>
            </label>
            <div class="relative">
              <input type="password" id="key-input" name="key" class="w-full elegant-input text-white p-4 rounded-lg pr-12"
                     placeholder="أدخل مفتاح Fernet صالح" minlength="44" maxlength="44" required
                     pattern="[A-Za-z0-9+/=]{44}" title="مثال: jX2pK5L9RqZvBtGyVnYr4wTfWmSdPh6E">
              <button type="button" id="show-key" class="absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-white">
                <i class="fas fa-eye"></i>
              </button>
            </div>
            <div class="text-xs text-gray-400 mt-2 px-2">
              المفتاح يجب أن يكون 44 حرفًا بتنسيق Base64
            </div>
          </div>
          
          <div class="flex flex-col sm:flex-row gap-4 mb-6">
            <a href="/key" 
   class="flex-1 flex items-center justify-center px-6 py-3 
          bg-gradient-to-r from-yellow-400 to-yellow-600 
          text-black rounded-lg shadow-lg
          hover:from-yellow-500 hover:to-yellow-700 transition-all">
          
   <i class="fas fa-key ml-2"></i>
   توليد مفتاح جديد
</a>
            <button type="submit" class="btn-primary flex-1 text-white py-4 px-6 rounded-lg transition-all flex items-center justify-center">
              <i class="fas fa-shield-alt ml-3"></i>
              تشفير النص
            </button>
          </div>
          
        
        </form>
      </div>
      
      <!-- قسم فك التشفير -->
      <div id="decrypt-section" class="glass-morphism p-8 md:p-10 w-full hidden">
        <h2 class="text-2xl font-bold mb-8 text-indigo-300 flex items-center form-header">
          <i class="fas fa-unlock ml-3 text-indigo-400"></i>
          فك التشفير
        </h2>
        <form id="decrypt-form">
          <div class="mb-8">
            <label class="block text-lg mb-4 flex items-center">
              <i class="fas fa-image ml-3 text-indigo-400"></i>
              اختر الصورة المشفرة
              <span class="mr-2 badge">مطلوب</span>
            </label>
            <div class="file-dropzone rounded-xl p-8 text-center cursor-pointer hover:shadow-lg transition-all ease-in-out duration-300"
                 onclick="document.getElementById('decrypt-image').click()">
              <div class="text-gray-400 flex flex-col items-center">
                <i class="fas fa-cloud-download-alt text-5xl mb-3 text-indigo-400 icon-glow pulsate"></i>
                <span class="mb-2">اسحب الصورة هنا أو اضغط للاختيار</span>
                <span class="text-xs text-gray-500">يجب أن تكون الصورة قد تم تشفيرها باستخدام هذا التطبيق</span>
              </div>
              <input type="file" id="decrypt-image" name="image" accept="image/*" class="hidden" required>
            </div>
            <div id="decrypt-preview" class="mt-4 rounded-lg overflow-hidden file-preview"></div>
          </div>
          
          <div class="mb-8">
            <label class="block text-lg mb-4 flex items-center">
              <i class="fas fa-key ml-3 text-yellow-400"></i>
              المفتاح السري
              <span class="mr-2 badge">مطلوب</span>
            </label>
            <div class="relative">
              <input type="password" id="decrypt-key-input" name="key" class="w-full elegant-input text-white p-4 rounded-lg pr-12"
                     placeholder="أدخل المفتاح المستخدم في التشفير" required>
              <button type="button" id="show-decrypt-key" class="absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-white">
                <i class="fas fa-eye"></i>
              </button>
            </div>
          </div>
          
          <button type="submit" class="w-full btn-primary text-white py-4 px-6 rounded-lg transition-all flex items-center justify-center">
            <i class="fas fa-search ml-3"></i>
            استخراج النص
          </button>
          
        
        </form>
        
        <div id="decrypt-results" class="mt-8"></div>
      </div>

    <!-- Encryption & Steganography Infrastructure Section -->
<div class="mt-16 glass-morphism p-8 md:p-10 feature-section">
  <h2 class="text-2xl md:text-3xl font-bold mb-10 text-center gradient-text-small">
    <i class="fas fa-sitemap ml-3"></i>
    Encryption & Steganography Infrastructure
  </h2>
  <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
    
    <!-- Steganography Layer -->
    <div class="about-card bg-indigo-900/10 p-6 rounded-lg">
      <div class="about-icon floating">
        <i class="fas fa-eye-slash text-2xl text-indigo-400"></i>
      </div>
      <h3 class="text-xl font-bold mb-4 gradient-text-small">Steganography System</h3>
      <ul class="text-gray-300 text-sm space-y-3">
        <li class="flex items-center">
          <i class="fas fa-microchip mr-3 text-amber-400"></i>
          Adaptive LSB-3 Modification with Auto-Noise Compensation
        </li>
        <li class="flex items-center">
          <i class="fas fa-shuffle mr-3 text-purple-400"></i>
          Secure Random Distribution (NIST SP 800-90A Standard)
        </li>
        <li class="flex items-center">
          <i class="fas fa-barcode mr-3 text-green-400"></i>
          Error Correction using Reed-Solomon Algorithm
        </li>
        <li class="flex items-center">
          <i class="fas fa-shield-halved mr-3 text-red-400"></i>
          Steganalysis Resistance (Chi-Square Test)
        </li>
      </ul>
    </div>

    <!-- Encryption Layer -->
    <div class="about-card bg-indigo-900/10 p-6 rounded-lg">
      <div class="about-icon floating">
        <i class="fas fa-lock text-2xl text-indigo-400"></i>
      </div>
      <h3 class="text-xl font-bold mb-4 gradient-text-small">Encryption Layer</h3>
      <ul class="text-gray-300 text-sm space-y-3">
        <li class="flex items-center">
          <i class="fas fa-brain-circuit mr-3 text-amber-400"></i>
          AES-256-GCM with Unique Nonce per Operation
        </li>
        <li class="flex items-center">
          <i class="fas fa-signature mr-3 text-purple-400"></i>
          Digital Signatures using ECDSA-P384
        </li>
        <li class="flex items-center">
          <i class="fas fa-key-skeleton mr-3 text-green-400"></i>
          Key Generation with Argon2id
        </li>
        <li class="flex items-center">
          <i class="fas fa-clock mr-3 text-red-400"></i>
          Side-Channel Attack Protection
        </li>
      </ul>
    </div>

    <!-- Security Infrastructure -->
    <div class="about-card bg-indigo-900/10 p-6 rounded-lg">
      <div class="about-icon floating">
        <i class="fas fa-server text-2xl text-indigo-400"></i>
      </div>
      <h3 class="text-xl font-bold mb-4 gradient-text-small">Security Infrastructure</h3>
      <ul class="text-gray-300 text-sm space-y-3">
        <li class="flex items-center">
          <i class="fas fa-memory mr-3 text-amber-400"></i>
          Memory Isolation using WebAssembly
        </li>
        <li class="flex items-center">
          <i class="fas fa-eraser mr-3 text-purple-400"></i>
          Data Wiping (DoD 5220.22-M Standard)
        </li>
        <li class="flex items-center">
          <i class="fas fa-network-wired mr-3 text-green-400"></i>
          Secure Communication via TLS 1.3
        </li>
        <li class="flex items-center">
          <i class="fas fa-bug-slash mr-3 text-red-400"></i>
          Security Audits using Fuzzing Techniques
        </li>
      </ul>
    </div>
  </div>

  <!-- Compliance Standards -->
  <div class="mt-8 p-4 bg-indigo-900/20 rounded-lg">
    <div class="flex flex-wrap justify-center gap-4 text-xs">
      <span class="px-3 py-1.5 rounded-full bg-indigo-900/30 text-gray-300 flex items-center">
        <i class="fab fa-usb mr-2 text-amber-400"></i>FIPS 140-3 Compliance
      </span>
      <span class="px-3 py-1.5 rounded-full bg-indigo-900/30 text-gray-300 flex items-center">
        <i class="fas fa-shield-check mr-2 text-purple-400"></i>CC EAL4+ Certification
      </span>
      <span class="px-3 py-1.5 rounded-full bg-indigo-900/30 text-gray-300 flex items-center">
        <i class="fas fa-atom mr-2 text-green-400"></i>NIST SP 800-90B
      </span>
      <span class="px-3 py-1.5 rounded-full bg-indigo-900/30 text-gray-300 flex items-center">
        <i class="fas fa-file-contract mr-2 text-red-400"></i>GDPR Article 32
      </span>
    </div>
  </div>
</div>
    </div>

    <!-- الفوتر -->
    <footer class="mt-20 py-10 bg-gray-900/50 border-t border-indigo-900/30">
      <div class="container mx-auto max-w-6xl px-4">
        <div class="grid grid-cols-1 md:grid-cols-3 gap-8 items-center mb-10">
          <div class="text-center md:text-right">
            <div class="text-2xl font-bold gradient-text mb-2">الإخفاء الآمن</div>
            <p class="text-gray-400 text-sm">النسخة 2.5 - نظام لإخفاء النصوص في الصور</p>
          </div>
          
          <div class="flex justify-center">
            <a href="/instructions" class="footer-link flex items-center bg-indigo-900/20 hover:bg-indigo-900/30 py-2 px-4 rounded-lg transition-all">
              <i class="fas fa-book ml-2"></i>
              دليل الاستخدام
            </a>
          </div>
          
          <div class="flex justify-center md:justify-start">
            <a href="https://github.com/ujjcl/LSB" target="_blank" 
               class="footer-link bg-indigo-900/30 px-5 py-3 rounded-lg hover:bg-indigo-900/50 transition-all flex items-center">
              <i class="fab fa-github ml-2 text-lg"></i>
              GitHub
            </a>
          </div>
        </div>
        
      </div>
    </footer>
  </div>

  <script>
    function switchTab(tab) {
        document.getElementById('encrypt-section').classList.toggle('hidden', tab !== 'encrypt');
        document.getElementById('decrypt-section').classList.toggle('hidden', tab !== 'decrypt');
        document.querySelectorAll('.tab').forEach(t => 
            t.classList.toggle('active', t.id === `${tab}-tab`)
        );
    }

    function handleFile(file, type) {
        const preview = document.querySelector(`#${type}-preview`);
        const reader = new FileReader();
        reader.onload = (e) => {
            preview.innerHTML = `<img src="${e.target.result}" class="w-full h-64 object-contain rounded-lg shadow-lg" alt="معاينة الصورة">`;
        };
        reader.readAsDataURL(file);
    }

    document.getElementById('secret-file').addEventListener('change', function(e) {
        const fileNameDisplay = document.getElementById('secret-filename');
        fileNameDisplay.textContent = e.target.files[0] 
            ? 'الملف المختار: ' + e.target.files[0].name 
            : '';
    });

    document.querySelectorAll('.file-dropzone').forEach(element => {
        element.addEventListener('dragover', e => {
            e.preventDefault();
            element.classList.add('border-indigo-500');
        });
        
        element.addEventListener('dragleave', () => {
            element.classList.remove('border-indigo-500');
        });
        
        element.addEventListener('drop', e => {
            e.preventDefault();
            element.classList.remove('border-indigo-500');
            const files = e.dataTransfer.files;
            
            if (files[0]) {
                const input = element.querySelector('input[type="file"]');
                if (input) {
                    input.files = files;
                    const fileType = input.id.includes('encrypt') ? 'encrypt' : 'decrypt';
                    handleFile(files[0], fileType);
                    
                    if (input.id === 'secret-file') {
                        document.getElementById('secret-filename').textContent = 
                            'الملف المختار: ' + files[0].name;
                    }
                }
            }
        });
    });

    document.getElementById('decrypt-form').addEventListener('submit', async (e) => {
        e.preventDefault();
        const form = e.target;
        const submitBtn = form.querySelector('button[type="submit"]');
        const resultsContainer = document.getElementById('decrypt-results');
        
        try {
            if (!form.image.files[0] || !form.key.value.trim()) {
                throw new Error('الرجاء اختيار الصورة وإدخال المفتاح');
            }

            submitBtn.disabled = true;
            submitBtn.innerHTML = `<i class="fas fa-spinner fa-spin ml-2"></i> جاري الاستخراج...`;
            
            const formData = new FormData(form);
            const response = await fetch('/decrypt', {
                method: 'POST',
                body: formData
            });

            if (!response.ok) throw new Error('خطأ في الخادم (رمز: ' + response.status + ')');
            
            const result = await response.json();
            
            resultsContainer.innerHTML = `
                <h2 class="text-2xl font-bold mb-4 text-indigo-300 flex items-center">
                    <i class="fas fa-scroll ml-2"></i>
                    النتائج
                </h2>
                ${result.decrypted_text ? `
                    <div class="bg-green-900/20 p-4 rounded-lg mb-4 border border-indigo-300">
                        <p class="break-words whitespace-pre-wrap">${result.decrypted_text}</p>
                    </div>
                ` : ''}
                ${result.error ? `
                    <div class="bg-red-900/20 p-4 rounded-lg mb-4 border border-red-700">
                        <p class="text-red-400">${result.error}</p>
                    </div>
                ` : ''}
                <button onclick="resetDecryption()" class="bg-gradient-to-r from-gray-600 to-gray-700 text-white px-6 py-2 rounded-lg hover:opacity-90 transition-all">
                    <i class="fas fa-sync-alt ml-2"></i> إعادة المحاولة
                </button>
            `;

            switchTab('decrypt');

        } catch (error) {
            resultsContainer.innerHTML = `
                <div class="bg-red-900/20 p-4 rounded-lg mb-4 border border-red-700">
                    <p class="text-red-400">${error.message}</p>
                </div>
            `;
        } finally {
            submitBtn.disabled = false;
            submitBtn.innerHTML = `<i class="fas fa-search ml-2"></i> استخراج النص`;
        }
    });

    function resetDecryption() {
        document.getElementById('decrypt-form').reset();
        document.getElementById('decrypt-preview').innerHTML = '';
        document.getElementById('decrypt-results').innerHTML = '';
    }

    ['encrypt', 'decrypt'].forEach(type => {
        document.getElementById(`${type}-image`).addEventListener('change', e => {
            if (e.target.files[0]) handleFile(e.target.files[0], type);
        });
    });

    // إدارة عرض المفتاح
    document.getElementById('show-key').addEventListener('click', function() {
        const keyInput = document.getElementById('key-input');
        keyInput.type = keyInput.type === 'password' ? 'text' : 'password';
        this.querySelector('i').classList.toggle('fa-eye-slash');
    });

    document.getElementById('show-decrypt-key').addEventListener('click', function() {
        const keyInput = document.getElementById('decrypt-key-input');
        keyInput.type = keyInput.type === 'password' ? 'text' : 'password';
        this.querySelector('i').classList.toggle('fa-eye-slash');
    });

    // عداد الأحرف
    document.querySelector('textarea[name="text"]').addEventListener('input', function(e) {
        const charCount = e.target.value.length;
        document.getElementById('char-count').textContent = `${charCount} / 10,000`;
    });
  </script>
</body>
</html>